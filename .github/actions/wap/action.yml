name: 'wap'

description: 'wap build and publish'

inputs:
  release-type:
    description: "Release type for publish. Can be none|alpha|beta|release"
    default: "alpha"
  curseforge-token:
    description: "Curseforge token to automate upload to Curseforge"
    required: false
    default: "invalid"

runs:
  using: "composite"
  steps:
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    - name: Install wap
      shell: bash
      run: |
        pipx install wow-addon-packager

    - name: wap build
      shell: bash
      run: |
        wap build


    - name: wap publish
      if: ${{ inputs.release-type != 'none' }}
      shell: bash
      run: |
        wap package --release-type ${{ inputs.release-type }} --curseforge-token ${{ inputs.curseforge-token }}
